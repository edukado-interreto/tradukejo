{% extends 'normal-page.html' %}
{% block title %}{{ project.name }} – sciigoj pri novaj tekstoj{% endblock %}
{% block pagetitle %}Sendi sciigojn pri novaj tekstoj en <a href="{% url 'project' project.pk %}">{{ project.name }}</a>{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
	<ol class="breadcrumb main-breadcrumb">
		<li class="breadcrumb-item"><a href="{% url 'projects' %}">Ĉefpaĝo</a></li>
		<li class="breadcrumb-item"><a href="{% url 'project' project.pk %}">{{ project.name }}</a></li>
		<li class="breadcrumb-item active" aria-current="page">Sciigoj pri novaj tekstoj</li>
	</ol>
</nav>

<p>Al la tradukantoj de kiuj lingvoj vi volas sendi informon pri tio, ke novaj tradukendaj tekstoj estas disponeblaj?</p>
{% if project.last_
slator_notification %}
<p>Lasta sciigo: {{ project.last_translator_notification }}.</p>
{% endif %}

<form action="" method="post">
	{% csrf_token %}
	<table class="table mt-4 mx-auto table-striped" style="width: auto;">
		<tr>
			<th>Lingvo</th>
			<th>Tradukite</th>
			<th>Retradukende</th>
			<th>Netradukite</th>
			<th>Sendi? (<a href="#" id="check_all">Ĉiuj</a>)</th>
		</tr>
		{% for lv in project.languageversion_set.all %}
		<tr>
			<td>
				<label for="checkbox_{{ lv.language.code }}" class="m-0">
					<span lang="{{ lv.language.code }}" dir="{{ lv.language.direction }}">{{ lv.language.name }}</span> ({{ lv.language.code }})
				</label>
			</td>
			<td class="text-right"><label for="checkbox_{{ lv.language.code }}" class="m-0">{{ lv.translated_percent|floatformat:"-2" }}&nbsp;%</label></td>
			<td class="text-right"><label for="checkbox_{{ lv.language.code }}" class="m-0">{{ lv.outdated_percent|floatformat:"-2" }}&nbsp;%</label></td>
			<td class="text-right"><label for="checkbox_{{ lv.language.code }}" class="m-0">{{ lv.untranslated_percent|floatformat:"-2" }}&nbsp;%</label></td>
			<td class="text-center">
				<input type="checkbox" value="{{ lv.language.code }}" name="send[]" id="checkbox_{{ lv.language.code }}" {% if lv.translated_percent == 100 %}disabled{% else %}checked{% endif %}>
			</td>
		</tr>
		{% endfor %}
	</table>
	<div class="text-center">
		<input type="submit" class="btn btn-primary" value="Sendi sciigojn">
	</div>
</form>

<script>
$('#check_all').click(function(e) {
	e.preventDefault();
	if ($('input[type=checkbox]:not(:disabled):not(:checked)').length > 0) {
		$('input[type=checkbox]:not(:disabled)').prop('checked', true);
	}
	else {
		$('input[type=checkbox]:not(:disabled)').prop('checked', false);
	}
});
</script>

{% endblock %}
